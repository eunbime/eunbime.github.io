---
title: JWT와 세션의 연결 사용 방식
date: 2025-01-10 10:00:00 +09:00
categories: [프론트엔드, CS]
tags: [JWT, Session]
---

**JWT와 세션 연결**은 서로 다른 인증 및 상태 관리 방식을 결합하여 보안성과 확장성을 모두 확보하는 방식이다. 이를 통해 각각의 단점을 보완하고, 시스템 요구사항에 맞는 최적의 인증 및 상태 관리 전략을 설계할 수 있다.

---

### **JWT와 세션을 연결하는 이유**

1. **JWT의 단점 보완**:
   - JWT는 무상태(stateless)로 설계되어 있으나, 토큰 유효 기간 동안 유출되면 보안 위험이 크다.
   - 짧은 만료 기간 설정이 가능하지만, 이로 인해 사용자는 자주 로그인이 필요할 수 있다.
2. **세션의 단점 보완**:
   - 세션은 서버 상태를 유지해야 하므로 분산 서버 환경에서는 세션 동기화가 필요하다.
   - 서버 메모리 또는 데이터베이스 사용량이 증가할 수 있다.
3. **조합의 장점**:
   - 세션 기반으로 보안성을 유지하면서도, JWT를 통해 효율적인 무상태 API 요청 처리가 가능하다.
   - 분산 서버 환경에서도 세션과 JWT를 연결하면 효율적인 상태 관리가 가능하다.

---

### **JWT와 세션 연결 방식**

### 1. **JWT를 세션처럼 사용**

JWT를 서버에서 세션 정보로 활용하면서 관리한다. 이 방식에서는 JWT를 세션 ID처럼 다루며, 서버에 유효한 JWT를 저장하고 검증 시 사용한다.

- **작동 방식**:
  1. 사용자가 로그인하면 서버에서 JWT를 생성한다.
  2. JWT를 서버의 세션 저장소(예: Redis, DB 등)에 저장하고, 클라이언트에 JWT를 반환한다.
  3. 클라이언트는 이후 요청마다 JWT를 헤더에 포함시켜 보낸다.
  4. 서버는 해당 JWT를 세션 저장소에서 검증하여 유효성을 확인한다.
  5. 로그아웃 시 서버에서 JWT를 삭제하여 무효화한다.
- **장점**:
  - JWT 유출 시에도 서버에서 이를 무효화할 수 있다.
  - 서버 간 세션 공유가 가능한 저장소(Redis 등)를 사용하면 확장성 확보 가능.
- **단점**:
  - 세션 저장소 관리가 추가적으로 필요하다.
  - 세션 기반의 무상태성을 완전히 보장하지 않는다.

### 2. **세션 토큰에 JWT 포함**

세션 ID를 클라이언트에 전달하는 대신, 세션과 관련된 정보를 JWT로 캡슐화하여 클라이언트로 전송한다.

- **작동 방식**:
  1. 사용자가 로그인하면 서버는 세션 ID와 함께 JWT를 생성한다.
  2. 클라이언트는 JWT를 저장하고 요청 시 전달한다.
  3. 서버는 세션 저장소에서 세션 ID와 JWT를 매칭하여 인증을 수행한다.
- **장점**:
  - JWT의 확장성과 세션의 보안성을 동시에 활용할 수 있다.
  - 클라이언트 측에서 JWT를 사용하여 API 요청을 처리할 수 있다.
- **단점**:
  - 세션 동기화가 필요한 분산 서버 환경에서는 추가적인 관리가 필요하다.
  - JWT를 서명하고 관리하는 추가적인 복잡성이 있다.

---

### **사용 예시**

### 1. **세션 기반 로그아웃 처리**

- **문제**: JWT는 기본적으로 무상태이므로, 서버에서 유효 기간 동안 해당 토큰을 무효화하기 어렵다.
- **해결**:
  - 서버에 유효한 JWT 리스트(화이트리스트) 또는 블랙리스트를 관리한다.
  - 로그아웃 시 클라이언트에서 전달된 JWT를 블랙리스트에 추가하고, 이후 요청에서 이를 차단한다.

### 2. **Redis를 활용한 세션 저장소**

- Redis와 같은 인메모리 데이터베이스를 활용하여 세션 정보를 관리한다.
- JWT는 클라이언트에 저장되지만, 서버는 Redis에서 JWT의 유효성을 확인한다.

### 3. **API 요청에서 JWT 활용**

- 로그인 상태는 세션으로 유지하되, API 요청마다 JWT를 사용하여 무상태(stateless) 인증을 처리한다.
- JWT를 짧은 만료 시간으로 설정하고, 세션을 통해 자동 갱신(refresh)한다.

---

### **결론**

JWT와 세션은 각각의 장단점이 뚜렷하며, 요구사항에 따라 유연하게 조합하여 사용할 수 있다.

- **보안성을 중시**한다면 세션 기반 인증을 강화하고 JWT를 추가로 활용하는 방식이 적합하다.
- **확장성과 효율성**이 중요하다면 Redis와 같은 분산 저장소를 활용하여 JWT와 세션을 결합하는 방식을 추천한다.
